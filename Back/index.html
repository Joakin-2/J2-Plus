<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="icon" href="ícone.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Background</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="background-video-container">
        <video autoplay loop muted>
            <source src="Space.mp4" type="video/mp4">
            Seu navegador não suporta o elemento de vídeo.
        </video>
    </div>
    
    <div id="content-container">
        <div id="clock"></div>
        <div id="date"></div>
        <div id="temperature"></div>
    </div>

    <script src="script.js"></script>
    <script>
        // Função para iniciar a música
        function iniciarMusica() {
            var audio = new Audio('louvores.webm');
            audio.play();
        }

        // Função para verificar a hora e iniciar a música às 22h
        function verificarHora() {
            var agora = new Date();
            var horas = agora.getHours();
            var minutos = agora.getMinutes();

            if (horas === 22 && !musicaIniciada) {
                iniciarMusica();
                musicaIniciada = true;
            } else if (horas !== 22) {
                musicaIniciada = false;
            }

            if (horas === 18 && minutos === 25) {
                tocarAlarme1();
            } else if (horas === 23 && minutos === 0) {
                window.open('https://j2plus.netlify.app/back/sleep.html', '_blank');
            } else if (horas === 23 && minutos === 30) {
                tocarAlarme2();
            }
        }

        function tocarAlarme1() {
            var alarmeAudio = new Audio('Escola.wav');
            alarmeAudio.play();
        }
        function tocarAlarme2() {
            var alarmeAudio = new Audio('Dormir.wav');
            alarmeAudio.play();
        }

        var musicaIniciada = false;
        setInterval(verificarHora, 60000);

        // Reconhecimento de Voz
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'pt-BR';
        recognition.interimResults = false;

        let reconhecimentoAtivo = false;

        // Função para iniciar ou parar o reconhecimento de voz
        function toggleReconhecimento() {
            if (reconhecimentoAtivo) {
                recognition.stop();
                reconhecimentoAtivo = false;
                console.log('Reconhecimento de voz parado.');
            } else {
                reconhecimentoAtivo = true;
                recognition.start();  // Inicia diretamente o reconhecimento
                console.log('Reconhecimento de voz iniciado.');
            }
        }

        // Configurações de eventos do reconhecimento
        recognition.onresult = (event) => {
            const comando = event.results[0][0].transcript.toLowerCase();
            console.log('Comando reconhecido:', comando);

            if (comando.includes('ler')) {
                abrirSite('https://j2plus.netlify.app/works/ler.html');
            } else if (comando.includes('trade')) {
                abrirAlgunsSites('https://br.investing.com/', 'https://br.tradingview.com/chart/wJjwLtXA/?symbol=BMFBOVESPA%3AIBOV', 'https://www.youtube.com/results?search_query=coringa+trade', 'https://www.youtube.com/results?search_query=laatus+reuni%C3%A3o+matinal');
            } else if (comando.includes('assistir')) {
                abrirSite('https://j2plus.netlify.app/streamings/yt/joca/index.html');
            } else if (comando.includes('previsão do tempo')) {
                obterPrevisaoDoTempo();
            } else {
                console.log('Comando não reconhecido.');
            }
        };

        recognition.onend = () => {
            if (reconhecimentoAtivo) {
                recognition.start();  // Reinicia automaticamente o reconhecimento após o término
            }
        };

        recognition.onerror = (event) => {
            console.error('Erro no reconhecimento de voz:', event.error);
        };

        // Funções para abrir sites

        function abrirAlgunsSites(url1, url2, url3, url4) {
            window.open(url1, '_blank');
            window.open(url2, '_blank');
            window.open(url3, '_blank');
            window.open(url4, '_blank');
            console.log(`Abrindo os sites: ${url1}, ${url2}, ${url3} e ${url4}`);
        }

        // Função para obter a previsão do tempo e falar
        function obterPrevisaoDoTempo() {
            const chaveAPI = 'bd2aa057407fb66d24136dab032d5bb8'; // Substitua com sua chave de API
            const cidade = 'São Paulo'; // Defina a cidade que você deseja
            const url = `https://api.openweathermap.org/data/2.5/weather?q=${cidade}&appid=${chaveAPI}&lang=pt&units=metric`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    const temperatura = data.main.temp;
                    const descricao = data.weather[0].description;
                    const fala = `A previsão do tempo em ${cidade} é de ${descricao} com temperatura de ${temperatura} graus Celsius.`;
                    console.log(fala);
                    falar(fala);
                })
                .catch(error => {
                    console.error('Erro ao obter previsão do tempo:', error);
                });
        }

        // Função para fazer o navegador falar
        function falar(texto) {
            const synth = window.speechSynthesis;
            const utterance = new SpeechSynthesisUtterance(texto);
            utterance.lang = 'pt-BR';
            synth.speak(utterance);
        }

        // Adiciona o evento de clique para ativar/desativar o reconhecimento
        document.getElementById('content-container').addEventListener('click', toggleReconhecimento);
    </script>
</body>
</html>
