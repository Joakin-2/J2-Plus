<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="icon" href="icon.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J2 Music</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1 id="titulo" style="display: flex; align-items: center; cursor: pointer;">
            <img src="icone.png" alt="Icon" style="width: 44px; height: auto; margin-left: 10px; margin-right: 10px;"> 
            J2 Music
        </h1>
        <div id="pesquisa" style="display: none; margin-top: 10px;">
            <input type="text" id="inputPesquisa" placeholder="Pesquisar..." style="padding: 10px;border-radius: 5px;border: 1px solid #ccc;background-color: #444;color: #fff;width: calc(92% - 22px);">
            <button onclick="buscar()" style="height: 40px; padding: 10px; background-color: #aa72fe; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">Buscar</button>
        <button style="height: 40px; padding: 10px; background-color: #aa72fe; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;" onclick="window.location.href='https://www.youtube.com/watch?v=57wccTN-ZyE&amp;list=WL&amp;index=1&amp;t=17s&amp;pp=gAQBiAQB8AUB'">Sax</button>
        </div>
    </header>
    
    <div class="container">
        <a href="#" class="video christ-gym" onclick="showPlaylist('Christ Gym');"
        onmousedown="startLock(this, 'Christ Gym')" 
        onmouseup="stopLock(this)" 
        onmouseleave="stopLock(this)">
            <h2>Christ Gym</h2>
        </a>
        <a href="#" class="video hip-praise" onclick="showPlaylist('Hip Praise');"
        onmousedown="startLock(this, 'Hip Praise')" 
        onmouseup="stopLock(this)" 
        onmouseleave="stopLock(this)">
            <h2>Hip Praise</h2>
        </a>
    </div>
    <div class="container">
        <a href="#" class="video praise" onclick="showPlaylist('Praise');"
        onmousedown="startLock(this, 'Praise')" 
        onmouseup="stopLock(this)" 
        onmouseleave="stopLock(this)">
            <h2>Praise</h2>
        </a>
        <a href="#" class="video fundo" onclick="showPlaylist('Fundo');"
        onmousedown="startLock(this, 'Fundo')" 
        onmouseup="stopLock(this)" 
        onmouseleave="stopLock(this)">
            <h2>Fundo</h2>
        </a>
    </div>
    <div class="container">
        <a href="#" class="video vibes" onclick="showPlaylist('Vibes');"
        onmousedown="startLock(this, 'Vibes')" 
        onmouseup="stopLock(this)" 
        onmouseleave="stopLock(this)">
            <h2>Vibes</h2>
        </a>
        <a href="#" class="video gym" onclick="showPlaylist('Gym');"
        onmousedown="startLock(this, 'Gym')" 
        onmouseup="stopLock(this)" 
        onmouseleave="stopLock(this)">
            <h2>Gym</h2>
        </a>
    </div>
    <div class="container">
        <a href="#" class="video fnf" onclick="showPlaylist('FNF');"
        onmousedown="startLock(this, 'FNF')" 
        onmouseup="stopLock(this)" 
        onmouseleave="stopLock(this)">
         <h2>FNF</h2>
     </a>
        <a href="#" class="video upload" onclick="uploadMusic();">
            <h2>+ Upload</h2>
        </a>
    </div>
            
    <div id="uploadModal">
        <div class="modal-content">
            <h2 style="text-align: center;">Upload de Música</h2>
            <div class="upload-form">
                <form id="uploadForm">
                    <label for="musicTitle">Título da Música:</label>
                    <input type="text" id="musicTitle" name="musicTitle" required>

                    <label for="musicFile">Escolha um arquivo de música:</label>
                    <input type="file" id="musicFile" name="musicFile" accept=".mp3,.ogg,.wav" required>

                    <input type="submit" value="Enviar Música">
                </form>
            </div>
            <div class="close">
                <button onclick="closeModal();">Fechar</button>
            </div>
        </div>
    </div>

    <div class="music-player" id="musicPlayer">
        <div class="music-player-content">
            <div id="musicHeader" style="display: flex; align-items: center; margin-bottom: 20px;">
                <button class="back-button" onclick="hideMusicPlayer()" style="cursor: pointer; margin-right: 10px; background: #0d0d0d; border: none; color: white; padding: 10px; border-radius: 5px;">
                    <i class="fas fa-arrow-left"></i> <!-- Ícone de voltar -->
                </button>
                <h2 id="currentPlaylistTitle" style="flex-grow: 1; text-align: center;">Nome da Playlist</h2>
            </div>
            <img src="" id="playlistImage" alt="Playlist Image" style="cursor: pointer;">
            <!-- Botão para mudar a imagem da playlist "Gym" - inicialmente escondido -->
            <button id="changeImageButton" class="outros-button" onclick="changeGymImage()" style="background: #1a1a1a; border: none; width: 40px; cursor: pointer; padding: 10px; display: none;">
                <i class="fas fa-image"></i> <!-- Ícone de imagem -->
            </button>
            <h2 id="musicTitle"></h2>
            <h3 id="songName" style="margin: 30px;"></h3>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
                <div class="progress-dot" id="progress-dot"></div>
            </div>
            <div class="time" style="display: flex; justify-content: space-between; margin-top: 10px;">
                <span id="current-time">00:00</span>
                <span id="duration">00:00</span>
            </div>            
            <br>
            <div class="controls" style="display: flex; align-items: center; justify-content: center;">
                <!-- Botão de Loop -->
                <button class="outros-button" onclick="toggleLoop()" style="background: #1a1a1a; border: none; width: 40px; cursor: pointer; padding: 10px;">
                    <i class="fas fa-redo"></i> <!-- Loop Icon -->
                </button>
                <button class="outros-button" onclick="previousTrack()" style="background: #1a1a1a; border: none; cursor: pointer; padding: 10px;">
                    <i class="fas fa-backward"></i> <!-- Ícone de voltar -->
                </button>
                <button class="outros-button" id="playPauseButton" onclick="togglePlayPause()" style="background: #1a1a1a; border: none; color: white; padding: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-pause-fill" viewBox="0 0 16 16">
                        <path d="M5.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-1 0v-9A.5.5 0 0 1 5.5 3zM10.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-1 0v-9a.5.5 0 0 1 .5-.5z"></path>
                    </svg>
                </button>
                <button class="outros-button" onclick="nextTrack()" style="background: #1a1a1a; border: none; cursor: pointer; padding: 10px;">
                    <i class="fas fa-forward"></i> <!-- Ícone de avançar -->
                </button>
                <!-- Botão de Coração (Favoritar) -->
                <button class="outros-button" onclick="toggleFavorite()" style="background: #1a1a1a; border: none; width: 40px; cursor: pointer; padding: 10px;">
                    <i class="fas fa-heart"></i> <!-- Ícone de coração -->
                </button>
            </div>
        </div>
    </div>    
    
    <audio id="audioPlayer" controls style="visibility: hidden;"></audio>
    
    <div id="musicSelection">
        <div id="musicTitleContainer" style="display: flex; align-items: center;">
            <i class="fas fa-arrow-left back-button" onclick="hideMusicSelection()"></i>
            <h2 id="playlistTitle"></h2> <!-- Título da seleção de músicas -->
        </div>
        <ul id="musicList"></ul>
    </div>  

    <script src="script.js"></script>
    <script>
        // Variáveis globais
        var currentPlaylist = null;
        var currentTrackIndex = 0;
        var audioPlayer = document.getElementById('audioPlayer');
        var playlistImage = document.getElementById('playlistImage');

        document.getElementById('playlistImage').addEventListener('click', function() {
    // Verifica se a imagem já está com 50% de largura
    if (this.style.maxWidth === '50%') {
        this.style.maxWidth = '100%'; // Se sim, volta para 100%
    } else {
        this.style.maxWidth = '50%'; // Caso contrário, diminui para 50%
    }
});

        document.getElementById('playlistImage').addEventListener('dblclick', function () {
            const audio = document.getElementById('audioPlayer');
            if (audio.paused) {
                audio.play();
            } else {
                audio.pause();
            }
        });
        function seek(event) {
            const progressBar = document.querySelector('.progress-container');
            const audio = document.getElementById('audioPlayer');
            const clickX = event.clientX - progressBar.getBoundingClientRect().left;
            const progressWidth = progressBar.offsetWidth;
            const newTime = (clickX / progressWidth) * audio.duration;

            audio.currentTime = newTime;
        }

        document.querySelector('.progress-container').addEventListener('click', seek);

        let lockTimeout; // Variável para rastrear o timeout do bloqueio

        function startLock(element, playlistName) {
    lockTimeout = setTimeout(() => {
        // Adiciona classe bloqueada
        element.classList.add('locked');
        
        // Define o conteúdo do botão com o título e o ícone
        element.innerHTML = `
            <h2>${playlistName}</h2>
            <span class="lock-icon">🔒</span>
        `;
        element.onclick = null; // Remove a ação de clique
    }, 1500); // Tempo para segurar
}

function stopLock(element) {
    // Cancela o timeout se o botão for solto antes do tempo
    clearTimeout(lockTimeout);
}

        const progressContainer = document.querySelector('.progress-container');
const progressBar = document.getElementById('progress-bar');
const progressDot = document.getElementById('progress-dot');
const audio = document.getElementById('audioPlayer');

// Função para atualizar a posição da bolinha e da barra
function updateProgress(event) {
    const rect = progressContainer.getBoundingClientRect();
    const offsetX = event.clientX - rect.left; // Posição do clique em relação ao container
    const width = rect.width; // Largura do container
    const percentage = Math.min(Math.max(offsetX / width, 0), 1); // Garante que o valor esteja entre 0 e 1

    progressBar.style.width = (percentage * 100) + '%'; // Atualiza a barra
    progressDot.style.left = (percentage * 100) + '%'; // Atualiza a bolinha

    // Atualiza o tempo do áudio
    audio.currentTime = percentage * audio.duration;
}

window.onload = () => {
    const playlistImage = document.getElementById('playlistImage');

    // Verifique se a variável 'playlist' está definida e contém a chave 'Gym'
    if (playlist && playlist['Gym'] && playlist['Gym'].images && playlist['Gym'].images.length > 0) {
        // Atribui a primeira imagem da lista de imagens da playlist
        playlistImage.src = playlist['Gym'].images[0];  
    } else {
        // Se não houver imagens, exibe uma imagem padrão
        playlistImage.src = '6.png';  
    }
};

function updateProgressBar() {
    const audio = document.getElementById('audioPlayer');
    const progressBar = document.getElementById('progress-bar');
    const progressDot = document.getElementById('progress-dot'); // Adicione esta linha
    const currentTime = document.getElementById('current-time');
    const duration = document.getElementById('duration');

    if (audio.duration) {
        // Atualiza o tempo atual e a duração
        const progress = (audio.currentTime / audio.duration) * 100;
        progressBar.style.width = progress + '%';

        // Atualiza a posição da bolinha
        progressDot.style.left = progress + '%'; // Adiciona esta linha

        // Formata o tempo
        const formatTime = (time) => {
            const minutes = Math.floor(time / 60);
            const seconds = Math.floor(time % 60).toString().padStart(2, '0');
            return `${minutes}:${seconds}`;
        };

        currentTime.textContent = formatTime(audio.currentTime);
        duration.textContent = formatTime(audio.duration);
    }
}


// Adiciona o evento de clique
progressContainer.addEventListener('click', updateProgress);

// Adiciona evento de arrastar
let isDragging = false;

progressDot.addEventListener('mousedown', () => {
    isDragging = true;
});

document.addEventListener('mouseup', () => {
    isDragging = false;
});

document.addEventListener('mousemove', (event) => {
    if (isDragging) {
        updateProgress(event);
    }
});

        document.getElementById('audioPlayer').addEventListener('timeupdate', updateProgressBar);


        // Event listener para detectar o término da música
        audioPlayer.addEventListener('ended', function () {
            nextTrack();
        });

        // Função para mostrar a lista de músicas de uma playlist
function showPlaylist(playlistName) {
    currentPlaylist = playlist[playlistName].tracks;
    currentTrackIndex = 0;
    document.getElementById('playlistImage').src = playlist[playlistName].image; // Define a imagem da playlist
    document.getElementById('currentPlaylistTitle').textContent = playlistName; // Atualiza o título no player
    document.getElementById('playlistTitle').textContent = playlistName; // Atualiza o título na seleção
    displayMusicSelection(playlistName);
// Verificar se a playlist é "Gym"
if (playlistName === 'Gym') {
                // Mostrar o botão de troca de imagem
                changeImageButton.style.display = 'inline-block';
            } else {
                // Esconder o botão de troca de imagem
                changeImageButton.style.display = 'none';
            }

            // Exibir a imagem da playlist atual
            const playlistImage = document.getElementById('playlistImage');
            playlistImage.src = playlist[playlistName].image;
        }

        // Função para alternar as imagens da playlist Gym
        let currentImageIndex = 0;

        function changeGymImage() {
            currentImageIndex++;
            if (currentImageIndex >= playlist['Gym'].images.length) {
                currentImageIndex = 0; // Se alcançar a última imagem, volta para a primeira
            }

            const playlistImage = document.getElementById('playlistImage');
            playlistImage.src = playlist['Gym'].images[currentImageIndex];
        }

        /// Função para exibir a seleção de músicas
function displayMusicSelection(playlistName) {
    // Atualiza o título da playlist
    var playlistTitle = document.getElementById('playlistTitle');
    playlistTitle.textContent = playlistName;

    // Obtém a lista de músicas
    var musicList = document.getElementById('musicList');
    musicList.innerHTML = ''; // Limpa a lista antes de adicionar novas músicas

    // Itera sobre a lista de faixas e cria elementos para cada uma
    currentPlaylist.forEach(function (track, index) {
        var listItem = document.createElement('li');

        // Cria o elemento para a linha vertical
        var colorLine = document.createElement('div');
        colorLine.style.width = '5px'; // Largura da linha
        colorLine.style.height = '30px'; // Altura da linha
        colorLine.style.background = 'linear-gradient(45deg, #ff4500, yellow)'; // Gradiente RGB
        colorLine.style.marginRight = '10px'; // Espaçamento entre a linha e o título
        colorLine.style.display = 'inline-block'; // Faz com que a linha fique ao lado do texto

        // Cria o elemento para o título da música
        var musicTitle = document.createElement('span');
        musicTitle.classList.add('music-title');
        musicTitle.textContent = songNames[track]; // Certifique-se de que 'track' é o índice correto em 'songNames'

        // Cria o elemento para os ícones de controle
        var icons = document.createElement('span');
        icons.classList.add('icons');
        icons.innerHTML = `
            <i class="fas fa-play" onclick="playMusic(${index})" style="cursor: pointer;"></i>
            <i class="fas fa-heart" style="cursor: pointer;"></i>
        `;

        // Adiciona os elementos ao item da lista
        // listItem.appendChild(colorLine);
        listItem.appendChild(musicTitle);
        listItem.appendChild(icons);
        musicList.appendChild(listItem);
    });

    // Exibe a seleção de músicas
    document.getElementById('musicSelection').style.display = 'flex';
}

        // Função para esconder a seleção de músicas
        function hideMusicSelection() {
            document.getElementById('musicSelection').style.display = 'none';
        }

        // Função para reproduzir uma música
        function playMusic(index) {
            var track = currentPlaylist[index];
            var musicPlayer = document.getElementById('musicPlayer');
            var musicTitle = document.getElementById('musicTitle');
            var songName = document.getElementById('songName');
            var musicSource = document.getElementById('audioPlayer');

            musicTitle.textContent = songNames[track];
            songName.textContent = songNames[track]; // Mostra o nome da música
            musicSource.src = track;
            musicSource.load();
            musicSource.play();
            musicPlayer.classList.add('show');

            // Esconder a seleção de músicas
            hideMusicSelection();
        }

        // Função para exibir o player de música
        function showMusicPlayer() {
            var musicPlayer = document.getElementById('musicPlayer');
            musicPlayer.classList.add('show');
        }

        // Função para pausar ou reproduzir música
        function togglePlayPause() {
            const audio = document.getElementById('audioPlayer');
            const button = document.getElementById('playPauseButton');
            const isPlaying = !audio.paused;

            if (isPlaying) {
                audio.pause();
                button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16"><path d="M11.596 8.697a.5.5 0 0 1 0 .607l-6 4.5a.5.5 0 0 1-.896-.447V3.75a.5.5 0 0 1 .896-.447l6 4.5z"/></svg>';
            } else {
                audio.play();
                button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-pause-fill" viewBox="0 0 16 16"><path d="M5.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h1zM11 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h1z"/></svg>';
            }
        }

        // Função para avançar para a próxima música
        function nextTrack() {
            currentTrackIndex = (currentTrackIndex + 1) % currentPlaylist.length;
            playMusic(currentTrackIndex);
        }

        // Função para voltar para a música anterior
        function previousTrack() {
            currentTrackIndex = (currentTrackIndex - 1 + currentPlaylist.length) % currentPlaylist.length;
            playMusic(currentTrackIndex);
        }

        // Função para esconder o player de música
        function hideMusicPlayer() {
            var musicPlayer = document.getElementById('musicPlayer');
            musicPlayer.classList.remove('show');
            audioPlayer.pause();
        }

        // Função para abrir o modal de upload de música
        function uploadMusic() {
            window.open("https://www.youtube.com/", "_blank");
            window.open("https://y2meta.is/pt/youtube-to-mp3/", "_blank");
            window.open("https://github.com/Juca3/J2-Plus/tree/main/Music", "_blank");
            window.open("https://keep.google.com/u/4/#NOTE/1lxsok0TJ_ko5PdXoxxx8Y7ggYXKjow9HdY9uizqrNf0-StbCOMVeRef7xWY6cg", "_blank");
            //var uploadModal = document.getElementById('uploadModal');
            //uploadModal.style.display = 'flex';
        }

        // Função para fechar o modal de upload de música
        function closeModal() {
            var uploadModal = document.getElementById('uploadModal');
            uploadModal.style.display = 'none';
        }

        // Evento para detectar o envio de música
        var uploadForm = document.getElementById('uploadForm');
        uploadForm.addEventListener('submit', function (event) {
            event.preventDefault();
            var formData = new FormData(this);
            var musicTitle = formData.get('musicTitle');
            var musicFile = formData.get('musicFile');
            // Aqui você pode adicionar lógica para enviar o arquivo para o servidor
            console.log('Título da música:', musicTitle);
            console.log('Arquivo de música:', musicFile);
            closeModal();
        });

        // Função para lidar com eventos de controle de mídia
        function handleMediaKeyEvent(event) {
            switch (event.code) {
                case 'MediaPlayPause':
                    togglePlayPause();
                    break;
                case 'MediaNextTrack':
                    nextTrack();
                    break;
                case 'MediaPreviousTrack':
                    previousTrack();
                    break;
                default:
                    break;
            }
        }

        // Adiciona um listener para eventos de controle de mídia
        document.addEventListener('keydown', handleMediaKeyEvent);

        document.getElementById('titulo').addEventListener('click', function () {
            const pesquisaDiv = document.getElementById('pesquisa');
            pesquisaDiv.style.display = pesquisaDiv.style.display === 'none' ? 'flex' : 'none';
        });

        function buscar() {
            const input = document.getElementById('inputPesquisa').value.trim();
            if (input) {
                window.location.href = `https://music.youtube.com/results?search_query=${encodeURIComponent(input)}`;
            }
        }

        let isLooping = false;  // Para controlar o estado de loop
        let isFavorite = false;  // Para controlar o estado de favorito

        function toggleLoop() {
    isLooping = !isLooping;
    audioPlayer.loop = isLooping; // Enable/disable loop on the audio element
    const loopButton = document.querySelector(".outros-button i.fa-redo");
    loopButton.style.color = isLooping ? "purple" : ""; // Highlight button when loop is active
    console.log(isLooping ? "Loop activated" : "Loop deactivated");
}

        // Função para alternar o favorito
        function toggleFavorite() {
            isFavorite = !isFavorite;
            const heartButton = document.querySelector(".outros-button i.fa-heart");

            // Altere o ícone ou o estilo conforme necessário
            if (isFavorite) {
                heartButton.style.color = "purple";  // Exemplo: cor vermelha quando favorito
            } else {
                heartButton.style.color = "";  // Cor padrão
            }

            console.log(isFavorite ? "Adicionado aos favoritos" : "Removido dos favoritos");
        }

    </script>
</body>
</html>
